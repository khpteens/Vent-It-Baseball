function create_pitcher(){pitcher=Vent.game.add.sprite(Vent.game.world.width/2-17,Vent.game.world.height/2+14,"pitcher"),pitcher.animations.add("pitch"),pitcher.anchor.set(.5),pitcher.scale.set(.5),pitcher.tint=1118481,pitcher.alpha=1}function create_instructions_prompt(){var t=Vent.game.add.group(),e=Vent.game.add.graphics(0,0);e.inputEnabled=!0,e.beginFill(0,1),e.boundsPadding=0,e.drawRect(0,0,Vent.game.width,Vent.game.height-30),e.alpha=0,t.add(e);var a=Vent.game.add.graphics(0,0);a.beginFill(0,1),a.boundsPadding=0,a.drawRect(0,Vent.game.height/2-100,Vent.game.width,200),a.alpha=.5,t.add(a),text="1. Click to pitch.\n2. Then click on the ball to hit it.",hasTouch&&(text="1. Tap to pitch.\n2. Then tap on the ball to hit it."),winText=Vent.game.add.text(settings.WIDTH/2,settings.HEIGHT/2-40,text,p_style),winText.anchor.set(.5),t.add(winText),ContinueBt=Vent.game.add.sprite(settings.WIDTH/2,settings.HEIGHT/2+45,"square"),createBt(ContinueBt,"Continue",!1),ContinueBt.events.onInputUp.add(function(){t.visible=!1},this),t.add(ContinueBt.group),t.bringToTop=!0}function createWorldSettings(){Vent.game.world.setBounds(0,0,settings.WIDTH,settings.HEIGHT),Vent.game.stage.backgroundColor=2236962}function createUI(){createInputListeners(),createButtons();var t=Vent.game.add.graphics(0,0);t.lineStyle(2,16777215,1),99>=hitGoal?t.drawRect(Vent.game.width-169,-1,110,60):t.drawRect(Vent.game.width-179,-1,120,60),t.boundsPadding=0,userInterface.add(t),hitGoal_txt=Vent.game.add.text(Vent.game.width-120,32,commaSeparateNumber(hitGoal),h3_style),hitGoal_txt.anchor.set(1,.5),userInterface.add(hitGoal_txt),hitGoal_icon=Vent.game.add.sprite(Vent.game.width-95,29,"icon-baseball"),hitGoal_icon.height=hitGoal_icon.width=30,hitGoal_icon.anchor.set(.5),userInterface.add(hitGoal_icon)}function updateUI(){var t=hitGoal-hitTotal;hitGoal_txt.text!==String(t)&&(hitGoal_txt.text=commaSeparateNumber(t),0==t&&(hitGoal_txt.text=""))}function createInputListeners(){bgGame.events.onInputDown.add(function(){"swing"==mode&&swing_start()},this),bgGame.events.onInputUp.add(function(){"pitch"==mode&&pitch_start()},this)}function createButtons(){userInterface=Vent.game.add.group();var t=Vent.game.add.sprite(Vent.game.width-29,29,"square");createBt(t,"icon-x",!1,"circle"),t.events.onInputUp.add(function(){gameExit(500)}),userInterface.add(t),userInterface.add(t.border),userInterface.add(t.label)}function setup_game(){mode="pitch",ball=Vent.game.add.sprite(0,0,"ball"),ball.anchor.set(.5),ball.scale.set(0),ball.alpha=0,bat=Vent.game.add.sprite(-50,Vent.game.height/3*2,"bat"),bat.anchor.set(0,.5),bat.scale.set(.6),bat.alpha=0,bat.tint=12303291}function pitch_update(){if("swing"==mode){var t=1;ball.loft+=t,ball.y+=ball.loft+ball.driftY,ball.x+=ball.driftX,ball.scale.x<1?(ball.scale.x+=.02,ball.scale.y+=.02):ball.y>Vent.game.world.height&&(ball.alpha=0,ball.x=ball.y=0,mode="pitch",pitcher.frame=0)}}function hit_update(){}function pitch_start(){hitGoal>hitTotal&&(pitcher.animations.play("pitch",15),setTimeout(function(){pitch_throw(),mode="swing"},700))}function pitch_throw(){ball.x=Vent.game.width/2,ball.y=Vent.game.height/2,ball.scale.set(0),ball.alpha=1,ball.loft=-10;var t=8;ball.driftX=Math.random()*t-t/2,ball.driftY=Math.random()*t-t}function swing_start(){var t=Vent.game.input.activePointer.x,e=Vent.game.input.activePointer.y;bat.alpha=1,bat.angle=45,bat.scale.set(1),bat.x=t-400,bat.y=e,Vent.game.add.tween(bat).to({angle:-150},700,Phaser.Easing.Cubic.Out,!0),Vent.game.add.tween(bat.scale).to({x:0,y:0},500,Phaser.Easing.Cubic.In,!0);var a=Math.abs(t-ball.x),i=Math.abs(e-ball.y),n=ball.width/4*3;n>a&&n>i&&(ball.alpha=0,createHit()),playAudio(bat_swing)}function createTrailGraphic(){null!=graphics&&graphics.destroy(),graphics=Vent.game.add.graphics(0,0),graphics.lineStyle(1,16777215,1),graphics.moveTo(swipeCoordX,swipeCoordY),graphics.lineTo(Vent.game.input.activePointer.x,Vent.game.input.activePointer.y)}function removeTrailGraphic(){graphics.destroy(),graphics=null}function createTrail(){trail=Vent.game.add.emitter(Vent.game.input.activePointer.x,Vent.game.input.activePointer.y,200),trail.makeParticles(["smoke1","smoke1","smoke3"]),trail.setAlpha(1,0,1e3,Phaser.Easing.Cubic.Out),trail.setScale(1,.5,1,.5,1e3,Phaser.Easing.Cubic.Out),trail.minParticleSpeed.setTo(-10,-10),trail.maxParticleSpeed.setTo(10,10),trail.setRotation(0,0),trail.gravity=0,trail.start(!1,1e3,.5,200),updateTrail()}function startTrail(){createTrail()}function stopTrail(){trail.destroy(),trail=null}function updateTrail(){null!=trail&&(trail.emitX=Vent.game.input.activePointer.x,trail.emitY=Vent.game.input.activePointer.y,createTrailGraphic())}function createAudio(){hit1=Vent.game.add.audio("hit1"),hit2=Vent.game.add.audio("hit2"),hit3=Vent.game.add.audio("hit3"),hit4=Vent.game.add.audio("hit4"),hit5=Vent.game.add.audio("hit5"),cheer=Vent.game.add.audio("cheer"),bat_swing=Vent.game.add.audio("swing"),hitSounds=[hit1,hit2,hit3]}function createVisualization(){bars_group=Vent.game.add.group(),sw=Vent.game.add.sprite(Vent.game.width/2,Vent.game.height/2,"wave"),sw.width=0,sw.height=0,sw.anchor.set(.5),sw2=Vent.game.add.sprite(Vent.game.width/2,Vent.game.height/2,"wave"),sw2.width=0,sw2.height=0,sw2.anchor.set(.5),sw2.rotation=45}function gameExit(t){Vent.game.input.onDown.removeAll(),Vent.game.input.onUp.removeAll(),Vent.game.add.tween(pitcher).to({alpha:0},600,Phaser.Easing.Cubic.Out,!0),Vent.game.add.tween(userInterface).to({alpha:0},600,Phaser.Easing.Cubic.Out,!0),setTimeout(function(){hitTotal=0,destroyAllHits(),barTotal=0,playing=[],hasTouch?Vent.game.state.start("Finish"):Vent.game.stateTransition.to("Finish")},t)}function create_particle_layer(){particles=Vent.game.add.group(),ball_group=Vent.game.add.group()}function createHit(){hitTotal++;var t=Math.floor(Math.random()*hitSounds.length);playAudio(hitSounds[t]);var e=Math.floor(4*Math.random());0==e&&setTimeout(function(){playAudio(cheer)},1e3);var a=Vent.game.input.activePointer.x,i=Vent.game.input.activePointer.y;createSmoke(a,i),createSplinters(a,i),createBall(ball.x,ball.y),hasTouch||create_bg_pop(),hitTotal>=hitGoal&&(gameExit(3500),playAudio(cheer))}function init_pop(){pop=Vent.game.add.sprite(0,0,"circle"),pop.alpha=0,bg_group.add(pop)}function create_bg_pop(){var t=Vent.game.input.activePointer.x,e=Vent.game.input.activePointer.y;pop.x=t,pop.y=e,pop.width=pop.height=0,pop.anchor.set(.5),pop.tint=16777215*Math.random(),pop.alpha=1,Vent.game.add.tween(pop).to({width:900,height:900,alpha:0},1e3,Phaser.Easing.Exponential.Out,!0)}function createSplinters(t,e){var a=Vent.game.add.emitter(t,e,4);a.makeParticles(["wood1","wood2","wood3","wood4","dirt2"]),a.bringToTop=!0,a.setAlpha(1,1,3e3),a.setScale(0,.5,0,.5,3e3),a.minParticleSpeed.setTo(-500,-600),a.maxParticleSpeed.setTo(500,200),a.setRotation(-360,360,3e3),a.gravity=500,a.start(!0,3e3,null,50),particles.add(a),hits.push(a)}function createBall(t,e){var a=Vent.game.add.emitter(t,e,1);a.makeParticles("ball"),a.bringToTop=!0,a.setAlpha(1,1,3e3),a.setScale(1,0,1,0,3e3,Phaser.Easing.Quintic.Out),a.minParticleSpeed.setTo(-200,-800),a.maxParticleSpeed.setTo(200,-500),a.setRotation(-180,180,3e3),a.gravity=900,a.start(!0,3e3,null,50),hits.push(a)}function createBall_2(t,e){var a=Vent.game.add.sprite(t,e,"ball");a.anchor.set(.5),a.scale.set(.1),ball_group.add(a)}function createSmoke(t,e){var a=1,i=2e3;hasTouch||(a=4,i=3e3);var n=Vent.game.add.emitter(t,e,a);n.makeParticles(["smoke1","smoke2","smoke3"]),n.setAlpha(1,0,i),n.setScale(0,5,0,5,3e3),n.minParticleScale=0,n.maxParticleScale=4,n.minParticleSpeed.setTo(-200,-200),n.maxParticleSpeed.setTo(200,200),n.setRotation(0,180,3e3),n.start(!0,i,null,50),particles.add(n),hits.push(n)}function createWave(t,e){var a=Vent.game.add.emitter(t,e,2);a.makeParticles("wave"),a.bringToTop=!0,a.setAlpha(.5,0,1e3),a.setScale(0,.35,0,.35,1e3),a.setRotation(-45,45,1e3),a.gravity=0,a.start(!0,1e3,null,1),particles.add(a),hits.push(a)}function updateHits(){var t=0,e=hits.length,a=9;if(e>a)for(var i=e-a,n=0;i>n;n++)hitsToDestroy.push(hits[n]);for(t=i;e>t;t++)updateHit(hits[t]);destroyHits()}function updateHit(t){t.y+=2,t.width+=5,t.height+=5,t.alpha-=.01,t.y>Vent.game.world.height&&hitsToDestroy.push(t)}function updateVisualization(){var t=playing.length,e=0;if(t>0){for(var a=0;t>a;a++){var i=playing[a].frame,n=playing[a].name;i>=audioData[n].length?playing[a].frame=-1:(playing[a].frame++,e+=Number(audioData[n][i]))}cleanPlayVisual()}add_audio_bar(e)}function add_audio_bar(t){var e=2,a=0,i=t*e,n=barTotal;0==lastY&&0==lastX&&(lastY=i);var r=Vent.game.add.sprite(n,Vent.game.height+a,"square");r.width=3,r.height=i,r.anchor.set(0,1),r.tint=7829367,bars.push(r),bars_group.add(r);var o=Vent.game.add.graphics(0,0);o.lineStyle(3,16777215,1),o.moveTo(lastX,Vent.game.height+a-lastY),o.lineTo(n,Vent.game.height+a-i),bars.push(o),bars_group.add(o),barTotal<Vent.game.width?(barTotal+=5,lastX=n,lastY=i):(bars_reset(),lastX=0,lastY=0)}function bars_reset(){barTotal=0;for(var t=0,e=bars.length;e>t;t++)bars[t].destroy();bars=[],lastY=0,lastX=0}function cleanPlayVisual(){for(var t=0;t<playing.length;t++)-1==playing[t].frame&&(playing.splice(t,1),t-=1)}function destroyAllHits(){for(var t=0,e=hits.length;e>t;t++)hitsToDestroy.push(hits[t]);hits=[],destroyHits()}function destroyHits(){for(var t=0,e=hitsToDestroy.length;e>t;t++)destroyHit(hitsToDestroy[t]);hitsToDestroy=[]}function destroyHit(t){t.destroy();for(var e=0,a=hits.length;a>e;e++)t==hits[e]&&hits.splice(e,1)}var Vent=Vent||{};Vent.Game=function(){};var COLOUR_WHITE=16777215,COLOUR_BLACK=0,hitTotal=0,trail=null,trailOn=!1,barTotal=0,mode,buttons,userInterface,bar_group,bg_group,ball_group,hits=[],hitSounds=[],hitsToDestroy=[],playing=[],stopPlaying=[],bars=[],graphics=null,bgGame,hitGoal_txt,sw,sw2,sb,lastX=0,lastY=500,audioLength=100,audioFileName,audioComplete=!1,averages=[],volumes=[],all=[],balls=[],bat,ball,pop,pitcher,batSwing;Vent.Game.prototype={create:function(){createWorldSettings(),bg_group=Vent.game.add.group(),bgGame=Vent.game.add.sprite(0,0,"field"),bgGame.width=Vent.game.world.width,bgGame.height=Vent.game.world.height,bgGame.inputEnabled=!0,bg_group.add(bgGame),create_pitcher(),init_pop(),create_particle_layer(),createCopyright(),createAudio(),setup_game(),createUI(),create_instructions_prompt()},update:function(){updateUI(),pitch_update(),hit_update()},render:function(){}};